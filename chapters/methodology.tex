\section{Pull angle}

An explanation about the coordinate system used at CMS is in order. The CMS uses coordinate system centred on the nominal collision point, the $x$ points towards the centre of the LHC, the $y$ axis points upwards and the $z$ axis points along the beam in the direction of the Jura mountains - see Fig. \ref{fig:CMScoordinates}. $\rho$ is the radial coordinate. The azimuthal angle $\phi$ is measured from the $x$ axis to the projection of the spatial vector $\textbf{p}$ in the $x-y$ plane. The polar angle $\theta$ is measure from the positive direction of the beam to the vector $\textbf{p}$. Pseudorapidity $\eta$ is defined as

\begin{equation}
\eta\equiv-\ln\left(\frac{\theta}{2}\right).
\end{equation}

The pseudorapidity is equal to

\begin{equation}
\eta=\ln\left(\frac{p+p_{L}}{p-p_{L}}\right),
\end{equation}

where $p$ is the magnitude of $\textbf{p}$ and $p_{L}$ is the longitudinal component of $\textbf{p}$ along the direction of the beam.
A measurement related to pseudorapidity is the rapidity $y$ defined as:

\begin{equation}
y\equiv\ln\left(\frac{E+p_{L}}{E-p_{L}}\right),
\end{equation}

where $E$ is the energy of the particle. For massless particles rapidity and pseudorapidity are equal. For our present purposes, rapidity and pseudorapidity can be used interchangeably without a loss of accuracy.

\begin{figure}[hptb]
  \centering
  \includegraphics[width=0.7\textwidth]{fig/coordinates/coordinates.pdf}
  \caption{The coordinate system of CMS.}
  \label{fig:CMScoordinates}
\end{figure}

We adopt the methodology proposed by \cite{Gallicchio:2010sw} to use the pull angle to reveal colour connection between two quark jets. The pull angle $\theta_{p}$ formed by the pull vector $\vec{v}_{p}$ and difference between two jets $\vec{J}_{2}-\vec{J}_{1}$ is shown in Fig. \ref{fig:pull_angle}. The $\phi$-$y$ coordinate system is used. 

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=1.0\textwidth]{fig/pull_angle.pdf}
  \caption{Pull angle $\theta_{p}$, pull vector $\vec{v}_{p}$ in a $y$-$\phi$ plane.}
  \label{fig:pull_angle}
\end{figure}

The pull vector is given by the formula

\begin{equation}
  \vec{v}_{p}=\sum_{i\in J}\frac{p^{T}_{i}|\vec{r}_{i}|}{p^{T}_{J}}\vec{r}_{i},
  \label{Eq:pull_angle}
\end{equation}

where $i$ is the index of the constituent of jet $J$, $p^{T}_{i}$ is the transverse moment of the jet constituent, $\vec{r}_{i}$ is the vectorial difference between the jet component and the jet, $p^{T}_{J}$ - the transverse moment of the jet.

Two jets that are colour connected are expected to have jet constituents dispersed in the area between the two jets. Hence the pull vector of $J_{1}$ would point towards $J_{2}$ and the pull angle would be narrow. For jets that are not colour connected the pull angle is expected to be distributed isotropically.

The methodology of the pull angle has been applied in the \DZERO experiment of Tevatron \cite{Abazov:2011vh} and the ATLAS experiment at the LHC in Run I \cite{Aad:2015lxa} and in Run II \cite{ATLAS:2017iaz}. We hope to outperform all results with the methodology of the pull angle with the state-of-the-art tracker of the CMS detector immersed in the 4 T magnetic field of the superconducting solenoid.

The anti-$k_{T}$ clustering algorithm ensures a conical jet shape in case the jet separation \DeltaR is more than double of the parameter $R$, which is set at 0.4 at CMS. This case is illustrated in Fig. \ref{fig:anti_kt_a}. In case of separation between jets \DeltaR being less than double of the parameter $R$ the hard jet will wean constituents from the soft jet. This is illustrated in Fig. \ref{fig:anti_kt_b}. This latter effect will have consequences for the colour flow analysis with the pull angle as it will induce a pull from the involved jets to each other. This warrants a separation of the cases $\DeltaR\leq2R$, $\DeltaR>2R$. 

\begin{figure}[hbtp]
  \def\twidth{0.5}
  \subfloat[$\Delta_{ij}=3.15$.]{
    \includegraphics[width=\twidth\textwidth]{fig/dR-3p150-pt2-075.pdf}
    \label{fig:anti_kt_a}
  }%
 \subfloat[$\Delta_{ij}=1.95$.]{
    \includegraphics[width=\twidth\textwidth]{fig/dR-1p950-pt2-075.pdf}
    \label{fig:anti_kt_b}
  }
   \caption{Jet shapes obtained with the anti-$k_{t}$ clustering. $R=1.5$ is used. Two cases are shown - $\Delta_{ij}=3.15$ and  $\Delta_{ij}=1.95$. The \pt of the hard jet is 100 GeV, the \pt of the soft jet is 75 GeV. Courtesy of Cacciari, Salam and Soyez.}
  \label{fig:anti_kt}
\end{figure}

Tracking efficiency of the detector is not perfect. It depends on the quality of the track finder algorithm and properties of the detector such as geometrical acceptance and material content. Fig. \ref{fig:2011_trackPerformance_MC_SingleParticles_pi_efficiencyVsPt}  shows the tracking efficiency of pions, a particle commonly resulting from quark hadronisation. Tracking efficiency is defined as the fraction of simulated charged particles that can be associated with corresponding reconstructed tracks. The tracking efficiency drops at low \pt of the particle. In our analysis we choose 1.0 GeV as the threshold and exclude particles whose \pt is below it from our analysis.

\begin{figure}[hbtp]
    \includegraphics[width=0.6\textwidth]{fig/figs_2011_trackPerformance_MC_SingleParticles_pi_efficiencyVsPt.png}
    \caption{Track reconstruction efficiencies for pions passing the high-purity quality requirements. Results are shown as a function of \pt (right), for the barrel, transition, and endcap regions, which are defined by the $\eta$ intervals of 0 - 0.9, 0.9 - 1.4 and 1.4 - 2.5, respectively. \cite{Chatrchyan:2014fea}}
    \label{fig:2011_trackPerformance_MC_SingleParticles_pi_efficiencyVsPt}
\end{figure}

\section{LEP method}

Another methodology of studying colour-connected jets in the process $e^{+}e^{-}\rightarrow q\overline{q}q\overline{q}$ at \sqrts=189-207 \GeV was used in various experiments of LEP (\cite{Abdallah:2006uq}, \cite{Abbiendi:2005es}, \cite{Achard:2003pe}). Two inter-\PW planes formed by colour-connected quarks and two intra-\PW planes formed by quarks that are not colour connected are introduced as shown in Fig. \ref{fig:LEP_method}. Particles are projected onto these planes and the angle with the leftmost quark $\chi_{1}$ is taken. If this angle is less than the angle $\chi_{0}$ between the quarks forming the plane (which means the particle is projected between the respective quarks) then the normalised angle $\chi_{R}=\frac{\chi_{1}}{\chi_{0}}$ is plotted in the region corresponding to the plane after a linear transformation

\begin{equation}
  \chi=\chi_{R} + n_{\text{plane}} - 1
\end{equation}

has been performed on the normalised angle. 

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.6\textwidth]{fig/L3method.pdf}
  \caption{Inter-\PW and intra-\PW planes in the process $e^{+}e{-}\rightarrow q\overline{q}q\overline{q}$ and the relative angle $\chi_{R}=\frac{\chi_{1}}{\chi_{0}}$.}
  \label{fig:LEP_method}
\end{figure}

In the \ttbar semileptonic decay an arrangament as shown in Fig. \ref{fig:LEP_method} is not possible. Therefore a modification as shown in Fig. \ref{fig:LEP_method_adaptation} is proposed. There is one plane formed by colour connected jets - the leading light jet \leadingjet and the second leading light jet \scndleadingjet from the hadronic decay of the \PW boson. Additionally there are 3 colour-free regions formed by 1) the furthest light jet $j^{W}_{f}$ and the hadronic \cPqb jet \hadronicb 2) the hadronic \cPqb jet \hadronicb and the closest light jet $j^{W}_{c}$, 3) the leading \cPqb jet \leadingb and the second leading \cPqb jet \scndleadingb. Whether a jet is close or far is determined with regard to the angle between jets in the Euclidian space. In the regions shown in Fig. \ref{fig:LEP_method_adaptation_qfhb} and Fig. \ref{fig:LEP_method_adaptation_hbqc} we may hope to observe colour reconnection effects.

\begin{figure}[hbtp]
  \centering
  \def\twidth{0.24}
  \subfloat[Colour-connected region \leadingjet - \scndleadingjet.]{%
    \includegraphics[width=\twidth\textwidth]{fig/LEP_adaptation/qlq2l.pdf}%
    \label{fig:LEP_method_adaptation_qlq2l}
  }\hfil
 \subfloat[Colour-free region $j^{W}_{f}$ - \hadronicb.]{%
    \includegraphics[width=\twidth\textwidth]{fig/LEP_adaptation/qfhb.pdf}%
    \label{fig:LEP_method_adaptation_qfhb}
 }\hfil
  \subfloat[Colour-free region \hadronicb - $j^{W}_{c}$.]{%
    \includegraphics[width=\twidth\textwidth]{fig/LEP_adaptation/hbqc.pdf}%
    \label{fig:LEP_method_adaptation_hbqc}
  }\hfil
  \subfloat[Colour-free region \leadingb - \scndleadingb.]{%
    \includegraphics[width=\twidth\textwidth]{fig/LEP_adaptation/blb2l.pdf}%
    \label{fig:LEP_method_adaptation_blb2l}
  }
  \caption{Adaptation of the LEP method to \ttbar semileptonic decay involving a colour - connected region and 3 colour-free regions.}
  \label{fig:LEP_method_adaptation}
\end{figure}

The method calls for a separation of hadronic and leptonic \cPqb quarks. Each \cPqb quark is paired to each \PW boson and the invariant mass is compared to the mass of the \cPqt quark - 173.34 \GeV. The \cPqb quark is assigned to the branch where the difference of the masses is the smallest. 
